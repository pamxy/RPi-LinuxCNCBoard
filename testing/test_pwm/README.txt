To run this test tipe the following command. 
halrun -I hal-test.hal

Part of this code is based in RC Servo Test code available from here: http://wiki.linuxcnc.org/cgi-bin/wiki.pl?RC_Servo_Test